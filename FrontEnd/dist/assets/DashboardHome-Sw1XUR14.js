import{c as v,r as a,f as y,j as t,L as d,d as h}from"./index-CBmwFr6s.js";import{g as w,h as E,i as S,j as C}from"./index-D8BIdLzO.js";import{G as D}from"./iconBase-DJyS9i5T.js";function F(r){return D({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 0c-17.7 0-32 14.3-32 32l0 19.2C119 66 64 130.6 64 208l0 18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416l384 0c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8l0-18.8c0-77.4-55-142-128-156.8L256 32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3l-64 0-64 0c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z"},child:[]}]})(r)}const k=()=>{const{user:r}=v(),[o,m]=a.useState([]),{getFirestoreStats:g}=y(),[l,u]=a.useState({name:"",role:""}),p=async()=>{try{const e=await r._id;console.log("userId----  ",r);const i=(await h.get("/notifications/notifications",{params:{userId:e}})).data.sort((c,n)=>new Date(n.createdAt)-new Date(c.createdAt)).slice(0,5);m(i)}catch(e){console.error("Error fetching data:",e)}};a.useEffect(()=>{p()},[]),a.useEffect(()=>{(async()=>{try{const s=await r;u(s)}catch(s){console.error("Error fetching user data:",s)}})()},[r]);const f=e=>{if(e=="admin")return"مدير";if(e=="editor")return"محرر";if(e=="manager")return"مدير";if(e=="viewer")return"مشاهد";if(e=="star")return"نجم";if(e=="user")return"مستخدم"},[b,j]=a.useState([]);a.useEffect(()=>{(async()=>{try{const s=await h.get("/dashboard/get"),{advertisementCount:i,userCount:c,activeAdvertisementCount:n}=s.data.data;j([{icon:t.jsx(E,{className:"text-3xl text-blue-500"}),title:"إجمالي الحملات",value:i,color:"text-blue-500"},{icon:t.jsx(S,{className:"text-3xl text-green-500"}),title:"الحملات النشطة",value:n,color:"text-green-500"},{icon:t.jsx(C,{className:"text-3xl text-slate-600"}),title:"النجوم ",value:c,color:"text-slate-600"}])}catch(s){console.error("Error fetching stats:",s)}})()},[g]);const[x,N]=a.useState(!1);return t.jsx("div",{className:"p- bg-gradient-to-br from-gray-100 to-gray-50 min-h-screen",children:t.jsxs("div",{className:" p-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 shadow-lg rounded-xl p-6 mb-6 flex flex-col md:flex-row items-center gap-6 relative transition-all duration-300 hover:shadow-2xl",children:[t.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-3 rounded-full shadow-md",children:t.jsx(w,{className:"text-3xl text-white"})}),t.jsxs("div",{className:"flex-1 text-center md:text-left",children:[t.jsxs("h2",{className:"text-2xl text-right font-bold text-gray-800 hover:text-gray-900 transition duration-300",children:["مرحباً، ",l==null?void 0:l.name]}),t.jsxs("p",{className:"text-gray-600 text-right mt-1",children:["الوظيفة: ",f(l==null?void 0:l.role)]})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{className:"relative text-gray-700 p-2 focus:outline-none hover:text-gray-900 transition duration-300",onClick:()=>N(!x),children:[t.jsx(F,{className:"text-2xl"}),o.filter(e=>!e.readed).length>0&&t.jsx("span",{className:"absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 animate-pulse",children:o.filter(e=>!e.readed).length})]}),x&&t.jsxs("div",{className:"absolute -right-52   mt-2 w-72 bg-white shadow-2xl rounded-lg p-4 text-gray-700 z-10 border border-gray-100 transition-all duration-300 transform origin-top-right scale-95 hover:scale-100",children:[t.jsxs("h3",{className:"font-bold mb-3 text-lg text-gray-900 flex items-center gap-2",children:[t.jsx("span",{className:"text-blue-500",children:"🔔"})," الإشعارات"]}),o.length>0?t.jsx("ul",{children:o.map((e,s)=>t.jsxs("li",{className:`border-b mt-1 border-gray-100 py-2 text-sm flex flex-col gap-1 hover:bg-gray-50 transition duration-300 p-2 rounded-md ${e.readed?"":"bg-blue-50"}`,children:[(e==null?void 0:e.title)==="مستخدم جديد"?t.jsx(d,{to:"/dashboard/employees",className:"text-indigo-900 font-semibold hover:text-indigo-700",children:t.jsx("p",{className:"text-sm text-indigo-900 whitespace-normal",children:e==null?void 0:e.message})}):t.jsx(d,{to:`/dashboard/users/${e.messageUserId}`,className:"text-indigo-900 font-semibold hover:text-indigo-700",children:t.jsx("p",{className:"text-sm text-indigo-900 whitespace-normal",children:e==null?void 0:e.message})}),t.jsx("p",{className:"text-gray-600",children:e.message})]},s))}):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"لا توجد إشعارات جديدة 🎉"}),t.jsx(d,{to:"/dashboard/notifications",className:"block text-center text-blue-500 mt-4 hover:underline",children:"عرض جميع الإشعارات"})]})]})]}),t.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"نظرة عامة على لوحة التحكم"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map((e,s)=>t.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-100 shadow-lg rounded-lg p-6 flex items-center gap-4 hover:shadow-xl transition-shadow",children:[e.icon,t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:e.title}),t.jsx("p",{className:`text-3xl font-bold mt-2 ${e.color}`,children:e.value})]})]},s))})]})})};export{k as default};
