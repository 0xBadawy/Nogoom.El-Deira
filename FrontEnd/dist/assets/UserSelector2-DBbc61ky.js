import{r as l,j as s,c as k}from"./index-D1GyvUbU.js";import{A as v}from"./data-BYJ6_0xl.js";const G=({initialSelectedUsers:y=[],onSelectionChange:c})=>{var b;const[d,N]=l.useState([]),[o,i]=l.useState(y),[m,h]=l.useState([]),[t,U]=l.useState({area:"",govrn:""}),[u,w]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const a=(await k.get("/user/stars_users")).data.data;N(a),h(a)}catch(r){console.error("Failed to fetch users:",r)}})()},[]),l.useEffect(()=>{let{area:e,govrn:r}=t;if(!e&&!r){h(d);return}const a=d.filter(n=>{var p,j;const _=((p=n.address)==null?void 0:p.area)||"",x=((j=n.address)==null?void 0:j.govern)||[],F=Array.isArray(x)?x.join(", "):x;return(!e||_===e)&&(!r||F.includes(r))});h(a)},[t,d]),l.useEffect(()=>{c&&c(o)},[o,c]);const A=e=>{i(r=>r.includes(e)?r.filter(a=>a!==e):[...r,e])},S=()=>{i(u?[]:m.map(e=>e._id)),w(!u)},f=e=>{const{name:r,value:a}=e.target;U(n=>({...n,[r]:a,...r==="area"?{govrn:""}:{}}))},g=((b=v.find(e=>e.name===t.area))==null?void 0:b.subGovernments)||[];return s.jsxs("div",{className:"w-full bg-white p-2 md:p-6 border rounded-2xl shadow-xl h-fit",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"اختر النجوم:"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-700 mb-1",children:"المنطقة:"}),s.jsxs("select",{name:"area",value:t.area,onChange:f,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"اختر المنطقة"}),v.map(e=>s.jsx("option",{value:e.name,children:e.name},e.name))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-700 mb-1",children:"المحافظات:"}),s.jsxs("select",{name:"govrn",value:t.govrn,onChange:f,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",disabled:!g.length,children:[s.jsx("option",{value:"",children:"اختر المحافظات"}),g.map((e,r)=>s.jsx("option",{value:e,children:e},r))]})]})]}),s.jsx("div",{className:"h-48 overflow-y-scroll border border-gray-300 rounded-lg p-3 space-y-3 bg-gray-50",children:m.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center border-b pb-2 mb-2",children:[s.jsx("input",{type:"checkbox",id:"select-all",checked:u,onChange:S,className:"w-5 h-5 accent-blue-500 rounded-md"}),s.jsx("label",{htmlFor:"select-all",className:"ml-3 text-gray-700 font-bold",children:"تحديد الكل"})]}),m.map(e=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:`user-${e._id}`,value:e._id,checked:o.includes(e._id),onChange:()=>A(e._id),className:"w-5 h-5 accent-blue-500 rounded-md"}),s.jsx("label",{htmlFor:`user-${e._id}`,className:"ml-3 text-gray-700",children:e.name})]},e._id))]}):s.jsx("p",{className:"text-gray-500",children:"لا توجد نتائج"})})]})};export{G as U};
